var a=require("electron");var f=require("electron");function h(){window.addEventListener("keyup",e=>{(e.code==="F12"||e.code==="KeyI"&&(e.ctrlKey||e.altKey)&&e.shiftKey)&&f.ipcRenderer.send("ToggleDevTools")})}var y=require("electron");function O(){let e=process.env.ORIGINAL_DISCORD_PRELOAD;if(e){y.ipcRenderer.send("RegisterPreload",e);let r=process.kill;process.kill=()=>{};try{require(e)}catch(t){console.error(t)}process.kill=r}}var m=require("electron");function T(){function e(){let r="webpackChunkdiscord_app";function t(n,o,c){let i=n[o];Object.defineProperty(n,o,{get(){return i},set(s){Object.defineProperty(n,o,{value:s,configurable:!0,enumerable:!0,writable:!0});try{c(s)}catch(p){console.error(p)}return s},configurable:!0})}Reflect.has(window,r)||t(window,r,n=>{t(n,"push",()=>{n.push([[Symbol()],{},o=>{o.d=(c,i)=>{for(let s in i)!Reflect.has(i,s)||c[s]||Object.defineProperty(c,s,{get:()=>i[s](),set:p=>{i[s]=()=>p},enumerable:!0,configurable:!0})}}]),n.pop()})})}m.webFrame.top.executeJavaScript("("+e+")()")}var P=require("http"),d=null,g=null;function v(e){return new Promise((r,t)=>{let n="";e.on("data",o=>{n+=o}),e.on("end",()=>{try{r(JSON.parse(n))}catch(o){t(o)}})})}function b(e){let r={};for(let t=0;t<e.length;t+=2)r[e[t].toLowerCase()]=e[t+1];return r}var l={"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"content-type","Access-Control-Allow-Methods":"GET, POST, PUT, PATCH, DELETE, OPTIONS"},k=P.createServer(async(e,r)=>{if(!d){r.writeHead(500,l),r.end(JSON.stringify({ok:!1,error:"HTTP Handler not set"}));return}if(e.method=="OPTIONS"){r.writeHead(200,l),r.end();return}if(e.headers=b(e.rawHeaders),e.headers["content-type"]=="application/json")try{e.body=await v(e)}catch(t){r.writeHead(400,l),r.end(JSON.stringify({ok:!1,error:t.message}));return}try{let t=await d({method:e.method,url:e.url,body:e.body||null,headers:e.headers});if(!t){r.writeHead(500,l),r.end(JSON.stringify({ok:!1,error:"HTTP Handler returned nothing."}));return}let{body:n,headers:o={},status:c=200}=t;o["Access-Control-Allow-Origin"]="*",o["Access-Control-Allow-Headers"]="content-type",o["Access-Control-Allow-Methods"]="GET, POST, PUT, PATCH, DELETE, OPTIONS",r.writeHead(c,o),r.end(n)}catch(t){r.writeHead(500,l),r.end(JSON.stringify({ok:!1,error:t?.stack||t?.message||t||"Unknown error"}));return}});function w(e){try{k.listen(e,()=>{console.log(`HTTP Server listening on port ${e}`)}),g=e}catch(r){if(e>6170)return;console.log(`Unable to listen on port ${e}. Trying next port...`,r),w(e+1)}}w(6160);var u={setHandler(e){d||(d=e)},getPort(){return g}};a.contextBridge.exposeInMainWorld(process.env.ACORD_PRELOAD_KEY,{require,process:{cwd:process.cwd(),kill:process.kill,platform:process.platform,version:process.version,versions:process.versions,env:(()=>{let e=JSON.parse(JSON.stringify(process.env));return delete e.ACORD_PRELOAD_KEY,e})()},isDevToolsOpen(){return a.ipcRenderer.sendSync("IsDevToolsOpen")},ipcRenderer:a.ipcRenderer,http:{getPort:u.getPort,setHandler:u.setHandler}});T();h();O();setInterval(()=>{try{DiscordNative.processUtils.purgeMemory()}catch{}},6e4);
